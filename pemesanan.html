<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TripNesia — Status Pesanan</title>
  <meta name="description" content="Pantau status pesanan TripNesia — periksa & kelola pemesanan wisata Anda." />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

  <header class="bg-white shadow sticky top-0 z-50">
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
      <a href="/index.html" class="text-2xl font-bold text-indigo-600">TripNesia</a>

      <div class="hidden md:flex items-center space-x-6">
        <a href="/index.html#destinasi" class="text-gray-600 hover:text-indigo-600">Beranda</a>
      </div>

      <div class="md:hidden">
        <button id="mobile-menu-button" aria-label="Open menu" class="text-gray-700 focus:outline-none">
          <svg id="icon-open" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <svg id="icon-close" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </nav>

    <div id="mobile-menu" class="md:hidden bg-white border-t border-gray-100 hidden">
      <div class="px-6 pt-4 pb-6 space-y-3">
        <a href="/index.html#destinasi" class="block text-gray-700 hover:text-indigo-600">Destinasi</a>
        <a href="/paket wisata.html" class="block text-gray-700 hover:text-indigo-600">Paket Wisata</a>
        <a href="/login.html" class="block text-indigo-700">Login</a>
        <a href="/regist_akun.html" class="block bg-indigo-600 text-white px-4 py-2 rounded-full text-center">Daftar</a>
      </div>
    </div>
  </header>

  <main class="flex-1">
    <!-- Status Pesanan -->
    <section class="container mx-auto px-6 py-8 bg-white rounded-lg shadow-sm mb-8">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold">Status Pesanan Anda</h2>
        <span class="text-sm text-gray-500">Periksa & kelola pemesanan</span>
      </div>

      <div id="orders" class="grid gap-4">
        <!-- order cards injected by JS -->
      </div>

      <div class="mt-4 text-sm text-gray-600">
        <h3 class="font-semibold">Ringkasan kebijakan pembatalan & reschedule</h3>
        <ul class="list-disc ml-5 mt-2">
          <li><strong>Pembatalan:</strong> Jika pesanan dibatalkan 7 hari sebelum keberangkatan, pengembalian dana 90% (biaya administrasi 10%). Pembatalan mendadak (&lt;48 jam) tidak dapat dikembalikan untuk layanan tertentu.</li>
          <li><strong>Reschedule (Penjadwalan Ulang):</strong> Bisa dilakukan hingga 3 hari sebelum keberangkatan tanpa biaya tambahan, tergantung ketersediaan. Reschedule pada waktu dekat (&lt;72 jam) mungkin dikenakan biaya atau perubahan harga.</li>
          <li><strong>Proses:</strong> Klik tombol pada kartu pesanan untuk membatalkan atau reschedule. Sistem akan menampilkan konfirmasi dan estimasi pengembalian / biaya tambahan.</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-white py-8">
    <div class="container mx-auto px-6 text-center">
      <a href="/index.html" class="text-2xl font-bold text-white">TripNesia</a>
      <p class="text-gray-400 text-sm mt-2">Paket wisata terpercaya — pengalaman lokal terbaik.</p>
      <div class="mt-6 text-gray-500 text-sm">&copy; TripNesia 2025. All Rights Reserved.</div>
    </div>
  </footer>

  <!-- Cancel / Reschedule Modal -->
  <div id="modal-root" class="fixed inset-0 hidden items-center justify-center z-50">
    <div id="modal-backdrop" class="absolute inset-0 bg-black/50"></div>
    <div class="relative bg-white rounded-lg max-w-lg w-full p-6 mx-4 z-10">
      <h4 id="modal-title" class="text-lg font-semibold mb-2"></h4>
      <div id="modal-body" class="text-sm text-gray-700 mb-4"></div>

      <form id="reschedule-form" class="hidden space-y-3">
        <label class="text-sm">Pilih tanggal baru</label>
        <input id="reschedule-date" type="date" class="border rounded px-3 py-2 w-full" />
        <div class="text-xs text-gray-500">Reschedule dapat dikenakan biaya jika kurang dari 72 jam sebelum keberangkatan.</div>
      </form>

      <div class="flex justify-end gap-3">
        <button id="modal-cancel" class="px-4 py-2 rounded border">Batal</button>
        <button id="modal-confirm" class="px-4 py-2 rounded bg-indigo-600 text-white">Konfirmasi</button>
      </div>
    </div>
  </div>

  <script>
    // Mobile menu toggle
    const mobileBtn = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const iconOpen = document.getElementById('icon-open');
    const iconClose = document.getElementById('icon-close');
    mobileBtn?.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
      iconOpen?.classList.toggle('hidden');
      iconClose?.classList.toggle('hidden');
    });

    // Sample orders (demo)
    const orders = [
      { id: 'A001', package: 'Paket Bali 4H/3M', date: '2025-11-10', status: 'Pending', price: 2500000 },
      { id: 'A002', package: 'Raja Ampat Diving', date: '2025-08-05', status: 'Confirmed', price: 7500000 },
      { id: 'A003', package: 'Bromo Sunrise', date: '2025-09-01', status: 'Paid', price: 950000 }
    ];

    // Orders rendering & management
    const ordersContainer = document.getElementById('orders');
    function escapeHtml(s) {
      return (s || '').replace(/[&<>"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]);
    }
    function renderOrderCard(o) {
      const div = document.createElement('div');
      div.className = 'p-4 border rounded flex items-center justify-between gap-4';
      const left = document.createElement('div');
      left.innerHTML = `<div class="font-semibold">${escapeHtml(o.package)}</div>
                        <div class="text-sm text-gray-500">ID: ${o.id} • Tanggal: ${new Date(o.date).toLocaleDateString('id-ID')}</div>
                        <div class="text-sm mt-1">Rp ${o.price.toLocaleString('id-ID')}</div>`;
      const right = document.createElement('div');
      right.className = 'flex flex-col gap-2 items-end';
      const statusColors = { Pending:'bg-yellow-200 text-yellow-800', Confirmed:'bg-blue-200 text-blue-800', Paid:'bg-green-200 text-green-800', Rescheduled:'bg-indigo-200 text-indigo-800', Cancelled:'bg-red-200 text-red-800' };
      const statusBadge = document.createElement('span');
      statusBadge.className = `px-3 py-1 rounded-full text-xs font-semibold ${statusColors[o.status] || 'bg-gray-200 text-gray-700'}`;
      statusBadge.textContent = o.status;
      right.appendChild(statusBadge);

      const btnGroup = document.createElement('div');
      btnGroup.className = 'flex gap-2 mt-2';
      const btnDetail = document.createElement('button');
      btnDetail.className = 'px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200';
      btnDetail.textContent = 'Detail';
      btnDetail.onclick = () => alert(`Detail pesanan ${o.id}:\nPaket: ${o.package}\nTanggal: ${o.date}\nStatus: ${o.status}\nHarga: Rp ${o.price.toLocaleString('id-ID')}`);
      btnGroup.appendChild(btnDetail);

      if(o.status !== 'Cancelled' && o.status !== 'Paid') {
        const btnReschedule = document.createElement('button');
        btnReschedule.className = 'px-3 py-1 bg-indigo-600 text-white rounded text-sm hover:bg-indigo-700';
        btnReschedule.textContent = 'Reschedule';
        btnReschedule.onclick = () => openModal('reschedule', o);
        btnGroup.appendChild(btnReschedule);

        const btnCancel = document.createElement('button');
        btnCancel.className = 'px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700';
        btnCancel.textContent = 'Batal';
        btnCancel.onclick = () => openModal('cancel', o);
        btnGroup.appendChild(btnCancel);
      }

      right.appendChild(btnGroup);
      div.appendChild(left);
      div.appendChild(right);
      return div;
    }

    function renderOrders() {
      ordersContainer.innerHTML = '';
      orders.forEach(o => ordersContainer.appendChild(renderOrderCard(o)));
    }
    renderOrders();

    // Modal logic
    const modalRoot = document.getElementById('modal-root');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const modalConfirm = document.getElementById('modal-confirm');
    const modalCancel = document.getElementById('modal-cancel');
    const rescheduleForm = document.getElementById('reschedule-form');
    const rescheduleDate = document.getElementById('reschedule-date');
    let currentOrder = null;
    let currentAction = '';

    function openModal(action, order) {
      currentOrder = order;
      currentAction = action;
      modalRoot.classList.remove('hidden');
      if(action === 'cancel') {
        modalTitle.textContent = 'Konfirmasi Pembatalan';
        modalBody.textContent = `Apakah Anda yakin ingin membatalkan pesanan "${order.package}"?`;
        rescheduleForm.classList.add('hidden');
      } else if(action === 'reschedule') {
        modalTitle.textContent = 'Reschedule Pesanan';
        modalBody.textContent = `Pilih tanggal baru untuk pesanan "${order.package}":`;
        rescheduleForm.classList.remove('hidden');
        rescheduleDate.value = order.date;
      }
    }

    modalCancel.onclick = () => modalRoot.classList.add('hidden');
    modalConfirm.onclick = () => {
      if(currentAction === 'cancel') {
        currentOrder.status = 'Cancelled';
        alert(`Pesanan ${currentOrder.id} dibatalkan.`);
      } else if(currentAction === 'reschedule') {
        const newDate = rescheduleDate.value;
        if(newDate) {
          currentOrder.date = newDate;
          currentOrder.status = 'Rescheduled';
          alert(`Pesanan ${currentOrder.id} dijadwalkan ulang ke ${new Date(newDate).toLocaleDateString('id-ID')}`);
        } else {
          alert('Silakan pilih tanggal baru!');
          return;
        }
      }
      renderOrders();
      modalRoot.classList.add('hidden');
    };
  </script>

</body>
</html>
